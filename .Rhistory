table(df2008$workfor)
table(df2008$marry)
sum(is.na(df2008$Sbirth_y))
sum(is.na(df2008$marry))
df2007 %>%
filter(id %in% df2008$id) %>%
select(id, edu, grad_y, grad, workfor, workers, indust, occu, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, Sworkfor, Sworkers, Sindust, Soccu)->df21
merge(df2008,df21,by="id",all.x=TRUE)->df22
names(df22)
df22$workfor <- ifelse((df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workfor.y, df22$workfor.x)
df22$workers <- ifelse((df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workers.y, df22$workers.x)
df22$indust <- ifelse((df22$a06z05==1 | df22$a06z06==1),
df22$indust.y, df22$indust.x)
df22$occu <- ifelse((df22$a06z05==1 | df22$a06z06==1),
df22$occu.y, df22$occu.x)
df22$Sworkfor <- ifelse((df22$a21b03==1 | df22$a21b03==1 | df22$a21b05==1 | df22$a21b06==1),
df22$Sworkfor.y, df22$Sworkfor.x)
df22$Sworkers <- ifelse((df22$a21b03==1 | df22$a21b04==1 | df22$a21b05==1 | df22$a21b06==1),
df22$Sworkers.y, df22$Sworkers.x)
df22$Sindust <- ifelse((df22$a21b05==1 | df22$a21b06==1),
df22$Sindust.y, df22$Sindust.x)
df22$Soccu <- ifelse((df22$a21b05==1 | df22$a21b06==1),
df22$Soccu.y, df22$Soccu.x)
df2007 <- read_sav(file = "RR2007_new.sav")
df2008 <- read_sav(file = "RR2008.sav")
df2007 %>%
filter(id %in% df2008$id) %>%
select(id, edu, grad_y, grad, workfor, workers, indust, occu, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, Sworkfor, Sworkers, Sindust, Soccu)->df21
merge(df2008,df21,by="id",all.x=TRUE)->df22
df22$workfor <- ifelse((df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workfor.y, df22$workfor.x)
df22$workers <- ifelse((df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workers.y, df22$workers.x)
df22$indust <- ifelse((df22$a06z05==1 | df22$a06z06==1),
df22$indust.y, df22$indust.x)
df22$occu <- ifelse((df22$a06z05==1 | df22$a06z06==1),
df22$occu.y, df22$occu.x)
df22$Sworkfor <- ifelse((df22$a21b03==1 | df22$a21b03==1 | df22$a21b05==1 | df22$a21b06==1),
df22$Sworkfor.y, df22$Sworkfor.x)
df22$Sworkers <- ifelse((df22$a21b03==1 | df22$a21b04==1 | df22$a21b05==1 | df22$a21b06==1),
df22$Sworkers.y, df22$Sworkers.x)
df22$Sindust <- ifelse((df22$a21b05==1 | df22$a21b06==1),
df22$Sindust.y, df22$Sindust.x)
df22$Soccu <- ifelse((df22$a21b05==1 | df22$a21b06==1),
df22$Soccu.y, df22$Soccu.x)
names(df22)
dropname<-c(14:17,29:33,64:71,80:84,89:93)
select(df22, -c(dropname))->testdf
dropname<-c(14:17,30:33,64:71,81:84,90:93)
select(df22, -c(dropname))->testdf
write_sav(testdf,"RR2008_new.sav")
df2008 <- read_sav(file = "RR2008_new.sav")
df2009 <- read_sav(file = "RR2009.sav")
```{r}
df2008 <- read_sav(file = "RR2008_new.sav")
df2009 <- read_sav(file = "RR2009.sav")
df2008 %>%
filter(id %in% df2009$id) %>%
select(id, grad_y, grad, workfor, workers, indust, occu, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, Sworkfor, Sworkers, Sindust, Soccu)->df21
merge(df2009,df21,by="id",all.x=TRUE)->df22
(df22)
names(df22)
df22$workfor <- ifelse((df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workfor.y, df22$workfor.x)
df22$workers <- ifelse((df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workers.y, df22$workers.x)
df22$indust <- ifelse((df22$a06z05==1 | df22$a06z06==1),
df22$indust.y, df22$indust.x)
df22$occu <- ifelse((df22$a06z05==1 | df22$a06z06==1),
df22$occu.y, df22$occu.x)
df22$Sworkfor <- ifelse((df22$a21z03==1 | df22$a21z03==1 | df22$a21z05==1 | df22$a21z06==1),
df22$Sworkfor.y, df22$Sworkfor.x)
df22$Sworkers <- ifelse((df22$a21z03==1 | df22$a21z04==1 | df22$a21z05==1 | df22$a21z06==1),
df22$Sworkers.y, df22$Sworkers.x)
df22$Sindust <- ifelse((df22$a21z05==1 | df22$a21z06==1),
df22$Sindust.y, df22$Sindust.x)
df22$Soccu <- ifelse((df22$a21z05==1 | df22$a21z06==1),
df22$Soccu.y, df22$Soccu.x)
names(df22)
table(df22$workfor.x)
table(df22$workfor)
names(df22)
dropname<-c(15:18,30:31,33:34,76:83,92:95,101:104)
select(df22, -c(dropname))->testdf
write_sav(testdf,"RR2009_new.sav")
df2009 <- read_sav(file = "RR2009_new.sav")
df2010 <- read_sav(file = "RR2010.sav")
df2009 <- read_sav(file = "RR2009_new.sav")
df2010 <- read_sav(file = "RR2010.sav")
df2004 <- read_sav(file = "RR2004.sav")
df2003 <- read_sav(file = "RR2003_new.sav")
df2003 <- read_sav(file = "RR2003_new2.sav")
df2004 <- read_sav(file = "RR2004.sav")
df2003 <- read_sav(file = "RR2003_new2.sav")
df2004 <- read_sav(file = "RR2004.sav")
sum(is.na(df2004$marry))
table(df2004$marry)
table(df2003$marry)
sum(is.na(df2003$marry))
sum(is.na(df2004$marry))
df2003 %>%
filter(id %in% df2004$id) %>%
select(id, male, birth_y, edu, grad_y, grad, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, marry, Sbirth_y, Sedu)->df21
merge(df2004,df21,by="id",all.x=TRUE)->df22
df22$marry <- ifelse(df22$marry.x==0, df22$marry.y, df22$marry.x)
table(df22$marry)
table(df22$Sbirth_y.x)
df22$Sbirth_y <- ifelse((df22$marry==3 & is.na(df22$Sbirth_y.x)), df22$Sbirth_y.y, df22$Sbirth_y.x)
table(df22$Sbirth_y)
df22$Sedu <- ifelse((df22$marry==3 & df22$Sedu.x==0),
df22$Sedu.y, df22$Sedu.x)
table(df22$Sedu.x)
table(df22$Sedu)
names(df22)
dropname <- c(19:21,50,61:63)
select(df22, -c(dropname))->testdf
names(testdf)
write_sav(testdf, "RR2004_new.sav")
df2004 <- read_sav(file = "RR2004_new.sav")
df2005 <- read_sav(file = "RR2005.sav")
df2004 <- read_sav(file = "RR2004_new.sav")
df2005 <- read_sav(file = "RR2005.sav")
df2004 %>%
filter(id %in% df2005$id) %>%
select(id, male, birth_y, edu, grad_y, grad, indust, occu, workfor, workers, workplace, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, Sbirth_y, Sedu, Sindust, Soccu, Sworkfor, Sworkers, Sworkplace)->df21
merge(df2005,df21,by="id",all.x=TRUE)->df22
df22$indust<-ifelse(df22$a11b04==1,
df22$indust.y,df22$indust.x)
df22$occu<-ifelse(df22$a11b04==1,
df22$occu.y,df22$occu.x)
df22$workfor<-ifelse(df22$a11b04==1,
df22$workfor.y,df22$workfor.x)
df22$workers<-ifelse(df22$a11b04==1,
df22$workers.y,df22$workers.x)
df22$workplace<-ifelse(df22$a11b04==1,
df22$workplace.y,df22$workplace.x)
table(df22$Sedu.x)
table(df22$Sedu)
df22$Sbirth_y <- ifelse((df22$marry==3 & is.na(df22$Sbirth_y.x)), df22$Sbirth_y.y, df22$Sbirth_y.x)
df22$Sedu <- ifelse((df22$marry==3 & df22$Sedu.x==0),
df22$Sedu.y, df22$Sedu.x)
table(df22$Sedu)
table(df22$Sbirth_y.x)
table(df22$Sbirth_y)
df22$Sindust <- ifelse((df22$a27b04==1),
df22$Sindust.y,df22$Sindust.x)
df22$Soccu <- ifelse((df22$a27b04==1),
df22$Soccu.y,df22$Soccu.x)
df22$Sworkfor <- ifelse((df22$a27b04==1),
df22$Sworkfor.y,df22$Sworkfor.x)
df22$Sworkers<-ifelse(df22$a27b04==1,
df22$Sworkers.y,df22$Sworkers.x)
df22$Sworkplace<-ifelse(df22$a27b04==1,
df22$Sworkplace.y,df22$Sworkplace.x)
dropname<-c(9:14,21:22,25:30,64:68,74:80)
select(df22, -c(dropname))->testdf
names(testdf)
write_sav(testdf,"RR2005_new.sav")
df2005 <- read_sav(file = "RR2005_new.sav")
df2006 <- read_sav(file = "RR2006.sav")
df2005 %>%
filter(id %in% df2006$id) %>%
select(id, edu, grad_y, grad, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage)->df21
merge(df2006,df21,by="id",all.x=TRUE)->df22
write_sav(df22,"RR2006_new.sav")
df2006 <- read_sav(file = "RR2006_new.sav")
df2007 <- read_sav(file = "RR2007.sav")
df2006 %>%
filter(id %in% df2007$id) %>%
select(id, edu, grad_y, grad, workfor, workers, indust, occu, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, Sworkfor, Sworkers, Sindust, Soccu)->df21
merge(df2007,df21,by="id",all.x=TRUE)->df22
df22$workfor <- ifelse((df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workfor.y, df22$workfor.x)
df22$workers <- ifelse((df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workers.y, df22$workers.x)
df22$indust <- ifelse((df22$a06z05==1 | df22$a06z06==1),
df22$indust.y, df22$indust.x)
df22$occu <- ifelse((df22$a06z05==1 | df22$a06z06==1),
df22$occu.y, df22$occu.x)
df22$Sworkfor <- ifelse((df22$a21b03==1 | df22$a21b03==1 | df22$a21b05==1 | df22$a21b06==1),
df22$Sworkfor.y, df22$Sworkfor.x)
df22$Sworkers <- ifelse((df22$a21b03==1 | df22$a21b04==1 | df22$a21b05==1 | df22$a21b06==1),
df22$Sworkers.y, df22$Sworkers.x)
df22$Sindust <- ifelse((df22$a21b05==1 | df22$a21b06==1),
df22$Sindust.y, df22$Sindust.x)
df22$Soccu <- ifelse((df22$a21b05==1 | df22$a21b06==1),
df22$Soccu.y, df22$Soccu.x)
dropname <- c(14:17,27:30,63:70,80:83,89:92)
select(df22,-c(dropname))->testdf
write_sav(testdf,"RR2007_new.sav")
df2007 <- read_sav(file = "RR2007_new.sav")
df2008 <- read_sav(file = "RR2008.sav")
df2007 %>%
filter(id %in% df2008$id) %>%
select(id, edu, grad_y, grad, workfor, workers, indust, occu, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, Sworkfor, Sworkers, Sindust, Soccu)->df21
merge(df2008,df21,by="id",all.x=TRUE)->df22
df22$workfor <- ifelse((df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workfor.y, df22$workfor.x)
df22$workers <- ifelse((df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workers.y, df22$workers.x)
df22$indust <- ifelse((df22$a06z05==1 | df22$a06z06==1),
df22$indust.y, df22$indust.x)
df22$occu <- ifelse((df22$a06z05==1 | df22$a06z06==1),
df22$occu.y, df22$occu.x)
df22$Sworkfor <- ifelse((df22$a21b03==1 | df22$a21b03==1 | df22$a21b05==1 | df22$a21b06==1),
df22$Sworkfor.y, df22$Sworkfor.x)
df22$Sworkers <- ifelse((df22$a21b03==1 | df22$a21b04==1 | df22$a21b05==1 | df22$a21b06==1),
df22$Sworkers.y, df22$Sworkers.x)
df22$Sindust <- ifelse((df22$a21b05==1 | df22$a21b06==1),
df22$Sindust.y, df22$Sindust.x)
df22$Soccu <- ifelse((df22$a21b05==1 | df22$a21b06==1),
df22$Soccu.y, df22$Soccu.x)
dropname<-c(14:17,30:33,64:71,81:84,90:93)
select(df22, -c(dropname))->testdf
write_sav(testdf,"RR2008_new.sav")
``{r}
df2008 <- read_sav(file = "RR2008_new.sav")
df2009 <- read_sav(file = "RR2009.sav")
df2008 %>%
filter(id %in% df2009$id) %>%
select(id, grad_y, grad, workfor, workers, indust, occu, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, Sworkfor, Sworkers, Sindust, Soccu)->df21
merge(df2009,df21,by="id",all.x=TRUE)->df22
df22$workfor <- ifelse((df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workfor.y, df22$workfor.x)
df22$workers <- ifelse((df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workers.y, df22$workers.x)
df22$indust <- ifelse((df22$a06z05==1 | df22$a06z06==1),
df22$indust.y, df22$indust.x)
df22$occu <- ifelse((df22$a06z05==1 | df22$a06z06==1),
df22$occu.y, df22$occu.x)
df22$Sworkfor <- ifelse((df22$a21z03==1 | df22$a21z03==1 | df22$a21z05==1 | df22$a21z06==1),
df22$Sworkfor.y, df22$Sworkfor.x)
df22$Sworkers <- ifelse((df22$a21z03==1 | df22$a21z04==1 | df22$a21z05==1 | df22$a21z06==1),
df22$Sworkers.y, df22$Sworkers.x)
df22$Sindust <- ifelse((df22$a21z05==1 | df22$a21z06==1),
df22$Sindust.y, df22$Sindust.x)
df22$Soccu <- ifelse((df22$a21z05==1 | df22$a21z06==1),
df22$Soccu.y, df22$Soccu.x)
dropname<-c(15:18,30:31,33:34,76:83,92:95,101:104)
select(df22, -c(dropname))->testdf
write_sav(testdf,"RR2009_new.sav")
df2009 <- read_sav(file = "RR2009_new2.sav")
df2010 <- read_sav(file = "RR2010.sav")
df2009 <- read_sav(file = "RR2009_new2.sav")
df2010 <- read_sav(file = "RR2010.sav")
df2009 %>%
filter(id %in% df2010$id) %>%
select(id, grad_y, grad, workfor, workers, indust, occu, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, Sworkfor, Sworkers, Sindust, Soccu)->df21
merge(df2010,df21,by="id",all.x=TRUE)->df22
df22$workfor <- ifelse(
(df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workfor.y, df22$workfor.x)
df22$workers <- ifelse(
(df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workers.y, df22$workers.x)
df22$indust <- ifelse(
(df22$a06z05==1 | df22$a06z06==1),
df22$indust.y, df22$indust.x)
df22$occu <- ifelse(
(df22$a06z05==1 | df22$a06z06==1),
df22$occu.y, df22$occu.x)
df22$Sworkfor <- ifelse(
(df22$a21z03==1 | df22$a21z03==1 | df22$a21z05==1 | df22$a21z06==1),
df22$Sworkfor.y, df22$Sworkfor.x)
df22$Sworkers <- ifelse(
(df22$a21z03==1 | df22$a21z04==1 | df22$a21z05==1 | df22$a21z06==1),
df22$Sworkers.y, df22$Sworkers.x)
df22$Sindust <- ifelse(
(df22$a21z05==1 | df22$a21z06==1),
df22$Sindust.y, df22$Sindust.x)
df22$Soccu <- ifelse(
(df22$a21z05==1 | df22$a21z06==1),
df22$Soccu.y, df22$Soccu.x)
names(df22)
dropname<-c(15:18,31:34,64:71,80:83,89:92)
select(df22, -c(dropname))->testdf
write_sav(testdf,"RR2010_new.sav")
df2010 <- read_sav(file = "RR2010_new.sav")
df2011 <- read_sav(file = "RR2011.sav")
df2010 %>%
filter(id %in% df2011$id) %>%
select(id, grad_y, grad, workfor, workers, indust, occu, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, myear, Sbirth_y, Sworkfor, Sworkers, Sindust, Soccu)->df21
merge(df2011,df21,by="id",all.x=TRUE)->df22
df22$workfor <- ifelse(
(df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workfor.y, df22$workfor.x)
df22$workers <- ifelse(
(df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workers.y, df22$workers.x)
df22$indust <- ifelse(
(df22$a06z05==1 | df22$a06z06==1),
df22$indust.y, df22$indust.x)
df22$occu <- ifelse(
(df22$a06z05==1 | df22$a06z06==1),
df22$occu.y, df22$occu.x)
df22$myear <- ifelse(
(df22$a16a==1 | df22$a16a==2),
df22$myear.y, df22$myear.x)
df22$Sbirth_y <- ifelse(
(df22$a16a==1 | df22$a16a==2),
df22$Sbirth_y.y, df22$Sbirth_y.x)
table(df2011$myear)
table(df22$myear)
table(df2010$myear)
table(df2011$Sbirth_y)
table(df22$Sbirth_y)
table(df2010$Sbirth_y)
names(df22)
dropname<-c(15:18,26:27,31:34,64:72,81:84,90:95)
select(df22,-c(dropname))->testdf
df2010 <- read_sav(file = "RR2010_new.sav")
df2011 <- read_sav(file = "RR2011.sav")
df2010 %>%
filter(id %in% df2011$id) %>%
select(id, grad_y, grad, workfor, workers, indust, occu, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, myear, Sbirth_y, Sworkfor, Sworkers, Sindust, Soccu)->df21
merge(df2011,df21,by="id",all.x=TRUE)->df22
df22$workfor <- ifelse(
(df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workfor.y, df22$workfor.x)
df22$workers <- ifelse(
(df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workers.y, df22$workers.x)
df22$indust <- ifelse(
(df22$a06z05==1 | df22$a06z06==1),
df22$indust.y, df22$indust.x)
df22$occu <- ifelse(
(df22$a06z05==1 | df22$a06z06==1),
df22$occu.y, df22$occu.x)
df22$myear <- ifelse(
(df22$a16a==1 | df22$a16a==2),
df22$myear.y, df22$myear.x)
df22$Sbirth_y <- ifelse(
(df22$a16a==1 | df22$a16a==2),
df22$Sbirth_y.y, df22$Sbirth_y.x)
df22$Sworkfor <- ifelse(
(df22$a21z03==1 | df22$a21z03==1 | df22$a21z05==1 | df22$a21z06==1),
df22$Sworkfor.y, df22$Sworkfor.x)
df22$Sworkers <- ifelse(
(df22$a21z03==1 | df22$a21z04==1 | df22$a21z05==1 | df22$a21z06==1),
df22$Sworkers.y, df22$Sworkers.x)
df22$Sindust <- ifelse(
(df22$a21z05==1 | df22$a21z06==1),
df22$Sindust.y, df22$Sindust.x)
df22$Soccu <- ifelse(
(df22$a21z05==1 | df22$a21z06==1),
df22$Soccu.y, df22$Soccu.x)
names(df22)
dropname<-c(15:18,26:27,31:34,64:72,81:84,90:95)
select(df22,-c(dropname))->testdf
write_sav(testdf,"RR2011_new.sav")
df2011 <- read_sav(file = "RR2011_new.sav")
df2012 <- read_sav(file = "RR2012.sav")
df2011 <- read_sav(file = "RR2011_new.sav")
df2012 <- read_sav(file = "RR2012.sav")
merge(df2012,df21,by="id",all.x=TRUE)->df22
df2011 %>%
filter(id %in% df2011$id) %>%
select(id, grad_y, grad, workfor, workers, indust, occu, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, myear, Sbirth_y, Sworkfor, Sworkers, Sindust, Soccu)->df21
merge(df2012,df21,by="id",all.x=TRUE)->df22
df22$workfor <- ifelse(
(df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workfor.y, df22$workfor.x)
df22$workers <- ifelse(
(df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workers.y, df22$workers.x)
df22$indust <- ifelse(
(df22$a06z05==1 | df22$a06z06==1),
df22$indust.y, df22$indust.x)
df22$occu <- ifelse(
(df22$a06z05==1 | df22$a06z06==1),
df22$occu.y, df22$occu.x)
table(df2011$myear)
table(df22$myear)
df22$myear <- ifelse(
(df22$a16a==1 | df22$a16a==2),
df22$myear.y, df22$myear.x)
table(df22$myear)
table(df2010$myear)
table(df2012$myear)
table(df22$myear)
table(df2012$Sbirth_y)
df22$Sbirth_y <- ifelse(
(df22$a16a==1 | df22$a16a==2),
df22$Sbirth_y.y, df22$Sbirth_y.x)
table(df2011$Sbirth_y)
table(df22$Sbirth_y)
table(df22$Sworkfor)
table(df2012$Sworkfor)
df22$Sworkfor <- ifelse(
(df22$a21z03==1 | df22$a21z03==1 | df22$a21z05==1 | df22$a21z06==1),
df22$Sworkfor.y, df22$Sworkfor.x)
table(df22$Sworkfor)
df22$Sworkers <- ifelse(
(df22$a21z03==1 | df22$a21z04==1 | df22$a21z05==1 | df22$a21z06==1),
df22$Sworkers.y, df22$Sworkers.x)
df22$Sindust <- ifelse(
(df22$a21z05==1 | df22$a21z06==1),
df22$Sindust.y, df22$Sindust.x)
df22$Soccu <- ifelse(
(df22$a21z05==1 | df22$a21z06==1),
df22$Soccu.y, df22$Soccu.x)
names(df22)
dropname<-c(14:17,26,30:33,63:71,81:84,90:95)
select(df22,-c(dropname))->testdf
dropname<-c(14:17,25:26,30:33,63:71,81:84,90:95)
select(df22,-c(dropname))->testdf
write_sav(df22,"RR2012_new.sav")
df2012 <- read_sav(file = "RR2012_new.sav")
df2014 <- read_sav(file = "RR2014.sav")
df2012 <- read_sav(file = "RR2012_new.sav")
df2014 <- read_sav(file = "RR2014.sav")
df2014 <- read_sav(file = "RR2014.sav")
df2012 %>%
filter(id %in% df2014$id) %>%
select(id, grad_y, grad, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, myear, Sbirth_y)->df21
merge(df2014,df21,by="id",all.x=TRUE)->df22
table(df2012$myear)
df2012 <- read_sav(file = "RR2012_new.sav")
df2014 <- read_sav(file = "RR2014.sav")
df2011 <- read_sav(file = "RR2011_new.sav")
df2012 <- read_sav(file = "RR2012.sav")
df2011 %>%
filter(id %in% df2011$id) %>%
select(id, grad_y, grad, workfor, workers, indust, occu, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, myear, Sbirth_y, Sworkfor, Sworkers, Sindust, Soccu)->df21
merge(df2012,df21,by="id",all.x=TRUE)->df22
df22$workfor <- ifelse(
(df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workfor.y, df22$workfor.x)
df22$workers <- ifelse(
(df22$a06z03==1 | df22$a06z04==1 | df22$a06z05==1 | df22$a06z06==1),
df22$workers.y, df22$workers.x)
df22$indust <- ifelse(
(df22$a06z05==1 | df22$a06z06==1),
df22$indust.y, df22$indust.x)
df22$occu <- ifelse(
(df22$a06z05==1 | df22$a06z06==1),
df22$occu.y, df22$occu.x)
df22$myear <- ifelse(
(df22$a16a==1 | df22$a16a==2),
df22$myear.y, df22$myear.x)
df22$Sbirth_y <- ifelse(
(df22$a16a==1 | df22$a16a==2),
df22$Sbirth_y.y, df22$Sbirth_y.x)
df22$Sworkfor <- ifelse(
(df22$a21z03==1 | df22$a21z03==1 | df22$a21z05==1 | df22$a21z06==1),
df22$Sworkfor.y, df22$Sworkfor.x)
df22$Sworkers <- ifelse(
(df22$a21z03==1 | df22$a21z04==1 | df22$a21z05==1 | df22$a21z06==1),
df22$Sworkers.y, df22$Sworkers.x)
df22$Sindust <- ifelse(
(df22$a21z05==1 | df22$a21z06==1),
df22$Sindust.y, df22$Sindust.x)
df22$Soccu <- ifelse(
(df22$a21z05==1 | df22$a21z06==1),
df22$Soccu.y, df22$Soccu.x)
dropname<-c(14:17,25:26,30:33,63:71,81:84,90:95)
select(df22,-c(dropname))->testdf
write_sav(testdf,"RR2012_new.sav")
df2012 <- read_sav(file = "RR2012_new.sav")
df2014 <- read_sav(file = "RR2014.sav")
df2012 %>%
filter(id %in% df2014$id) %>%
select(id, grad_y, grad, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, myear, Sbirth_y)->df21
merge(df2014,df21,by="id",all.x=TRUE)->df22
table(df2012$marry)
table(df2014$marry)
table(df2014$myear)
table(df2014$Sbirth_y)
df22$myear <- ifelse(
(df22$a16a==1 | df22$a16a==2),
df22$myear.y, df22$myear.x)
df2012 <- read_sav(file = "RR2012_new.sav")
df2014 <- read_sav(file = "RR2014.sav")
df2012 %>%
filter(id %in% df2014$id) %>%
select(id, grad_y, grad, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, myear, Sbirth_y)->df21
merge(df2014,df21,by="id",all.x=TRUE)->df22
df22$myear <- ifelse(
(df22$a16a==1 | df22$a16a==2),
df22$myear.y, df22$myear.x)
df22$Sbirth_y <- ifelse(
(df22$a16a==1 | df22$a16a==2),
df22$Sbirth_y.y, df22$Sbirth_y.x)
table(df22$marry)
table(df22$myear)
names(df22)
dropname<-c(87:88,73,26:27)
select(df22, -c(dropname))->testdf
write_sav(testdf,"RR2014_new.sav")
df2012 <- read_sav(file = "RR2012_new.sav")
df2014 <- read_sav(file = "RR2014.sav")
df2012 %>%
filter(id %in% df2014$id) %>%
select(id, grad_y, grad, fwork_y, fwork_indust, fwork_occu, fworkfor, fwage, myear, Sbirth_y)->df21
merge(df2014,df21,by="id",all.x=TRUE)->df22
table(df2012$marry)
table(df2014$marry)
table(df2014$myear)
table(df2014$Sbirth_y)
df22$myear <- ifelse(
(df22$a16a==1 | df22$a16a==2),
df22$myear.y, df22$myear.x)
df22$Sbirth_y <- ifelse(
(df22$a16a==1 | df22$a16a==2),
df22$Sbirth_y.y, df22$Sbirth_y.x)
names(df22)
dropname<-c(87:88,73,26:27)
select(df22, -c(dropname))->testdf
write_sav(testdf,"RR2014_new.sav")
View(testdf)
